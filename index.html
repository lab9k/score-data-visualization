<!DOCTYPE html>
<html>

<head>
    <title>d3.js with leaflet.js</title>

    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7/leaflet.css" />
    <link rel="stylesheet" type="text/css" href="css/main.css">

    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://cdn.leafletjs.com/leaflet-0.7/leaflet.js"></script>

</head>

<body>

    <div id="map" style="width: 600px; height: 400px"></div>
    <script type="text/javascript" src="js/statistics.js"></script>
    <script type="text/javascript">
        getChartData()
    </script>

    <!-- <script type="text/javascript">

        var map = L.map('map').setView([54.775, 2.703], 5);
        mapLink =
            '<a href="http://openstreetmap.org">OpenStreetMap</a>';
        L.tileLayer(
            'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; ' + mapLink + ' Contributors',
                maxZoom: 18,
            }).addTo(map);

        // Initialize the SVG layer
        map._initPathRoot()

        // We pick up the SVG from the map object
        var svg = d3.select("#map").select("svg"),
            g = svg.append("g");

        d3.json("circles.json", function (collection) {
            // Add a LatLng object to each item in the dataset
            collection.objects.forEach(function (d) {
                d.LatLng = new L.LatLng(d.circle.coordinates[0],
                    d.circle.coordinates[1])
            })

            var feature = g.selectAll("circle")
                .data(collection.objects)
                .enter().append("circle")
                .style("stroke", "black")
                .style("opacity", .6)
                .style("fill", "red")
                .attr("r", 20);

            map.on("viewreset", update);
            update();

            function update() {
                feature.attr("transform",
                    function (d) {
                        return "translate(" +
                            map.latLngToLayerPoint(d.LatLng).x + "," +
                            map.latLngToLayerPoint(d.LatLng).y + ")";
                    }
                )
            }
        })
        

        //data for piechart
        var dataFromYou = [
            {
                "name": "Talks",
                "children": [
                    {
                        "name": "talk_1",
                        "size": 722,
                        "url": "www.example_1.com"
                    },
                    {
                        "name": "talk_2",
                        "size": 722,
                        "url": "www.example_2.com"
                    },
                    {
                        "name": "talk_3",
                        "size": 722,
                        "url": "www.example_3.com"
                    }
                ]
            }
        ];


        //***************************************************************************
        //pie chart test

        var data = dataFromYou[0].children;

        var width = 800,
            height = 250,
            radius = Math.min(width, height) / 2;

        var color = d3.scale.ordinal()
            .range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"]);

        var arc = d3.svg.arc()
            .outerRadius(radius - 10)
            .innerRadius(radius - 70);

        var pie = d3.layout.pie()
            .sort(null)
            .value(function (d) {
                return d.size;
            });

        var svg = d3.select("body").append("svg")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

        var g = svg.selectAll(".arc")
            .data(pie(data))
            .enter().append("g")
            .attr("class", "arc");

        g.append("path")
            .attr("d", arc)
            .style("fill", function (d) {
                return color(d.data.name);
            });

        g.append("text")
            .attr("transform", function (d) {
                return "translate(" + arc.centroid(d) + ")";
            })
            .attr("dy", ".35em")
            .style("text-anchor", "middle")
            .text(function (d) {
                return d.data.size;
            });
    </script> -->
</body>

</html>